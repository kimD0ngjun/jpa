# 커스텀 객체 풀 아이디어

## 1. 계기

문자열은 리터럴을 통해 메모리 최적화를 한다. 이는, 동일 내용을 가진 문자열 객체를 굳이 새롭게 생성하지 않고 이전 값 주소를 똑같이 참조하게 하는 것이다. 어차피 객체 해시코드, 주소 등이 달라져도 내부 내용만 같으면 사용자는 쓰기 편할 테니

뭔가 이 아이디어를 JPA의 영속성 컨텍스트에서 활용할 수 있지 않을까 싶었다. 단일 트랜잭션 내에서는 영속성 컨텍스트의 캐싱을 통해 동일 엔티티를 계속 사용하게 된다. 하지만 다음 트랜잭션은 새로운 영속성 컨텍스트가 생겨나기 떄문에 새로운 객체를 쓰게 된다. 이 과정에서 이전의 트랜잭션 때 생성된 객체가 빠르게 지워지리라는 보장이 없다. 가비지 컬렉터를 개발자가 제어할 수 없으므로.

그래서 문자열 풀처럼 커스텀 객체 풀을 활용해 다음 트랜잭션에서도 이전 트랜잭션 때 조회한 엔티티 객체 주소를 다시 재사용할 수 있는 방법을 구현(까진 못해도 아이디어 구상)해볼까 생각 중.

## 2. How

일단 영속성 컨텍스트와 트랜잭션을 깊게 공부해야 하지 않을까